(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[603],{3905:function(e,t,i){"use strict";i.d(t,{Zo:function(){return h},kt:function(){return u}});var r=i(7294);function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function a(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function o(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?a(Object(i),!0).forEach((function(t){n(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function s(e,t){if(null==e)return{};var i,r,n=function(e,t){if(null==e)return{};var i,r,n={},a=Object.keys(e);for(r=0;r<a.length;r++)i=a[r],t.indexOf(i)>=0||(n[i]=e[i]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)i=a[r],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}var c=r.createContext({}),l=function(e){var t=r.useContext(c),i=t;return e&&(i="function"==typeof e?e(t):o(o({},t),e)),i},h=function(e){var t=l(e.components);return r.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var i=e.components,n=e.mdxType,a=e.originalType,c=e.parentName,h=s(e,["components","mdxType","originalType","parentName"]),d=l(i),u=n,m=d["".concat(c,".").concat(u)]||d[u]||p[u]||a;return i?r.createElement(m,o(o({ref:t},h),{},{components:i})):r.createElement(m,o({ref:t},h))}));function u(e,t){var i=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var a=i.length,o=new Array(a);o[0]=d;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:n,o[1]=s;for(var l=2;l<a;l++)o[l]=i[l];return r.createElement.apply(null,o)}return r.createElement.apply(null,i)}d.displayName="MDXCreateElement"},1285:function(e,t,i){"use strict";i.r(t),i.d(t,{frontMatter:function(){return o},contentTitle:function(){return s},metadata:function(){return c},toc:function(){return l},default:function(){return p}});var r=i(4786),n=i(6843),a=(i(7294),i(3905)),o={id:"kb-202109-letsencrypt",title:"Let's Encrypt DST Root CA X3 expiry Sept 30th 2021"},s="Summary",c={unversionedId:"kb/kb-202109-letsencrypt",id:"kb/kb-202109-letsencrypt",isDocsHomePage:!1,title:"Let's Encrypt DST Root CA X3 expiry Sept 30th 2021",description:'Certificate trust mainly relies on the "root" issuing certificate (and intermediate certificates) being trusted by your computer.',source:"@site/docs/kb/202109-letsencrypt.md",sourceDirName:"kb",slug:"/kb/kb-202109-letsencrypt",permalink:"/docs/kb/kb-202109-letsencrypt",editUrl:"https://github.com/webprofusion/certify-docs/edit/master/docs/kb/202109-letsencrypt.md",tags:[],version:"current",sidebarPosition:202109,frontMatter:{id:"kb-202109-letsencrypt",title:"Let's Encrypt DST Root CA X3 expiry Sept 30th 2021"}},l=[{value:"Servers",id:"servers",children:[{value:"Servers with problems after expiry",id:"servers-with-problems-after-expiry",children:[]},{value:"Server fixes and how to switch chain before (or after) expiry",id:"server-fixes-and-how-to-switch-chain-before-or-after-expiry",children:[]},{value:"Switching to Chain 1 (modern)",id:"switching-to-chain-1-modern",children:[]},{value:"Switching to Chain 2 (legacy)",id:"switching-to-chain-2-legacy",children:[]}]},{value:"Non-IIS servers (Apache, nginx etc on Windows or Linux)",id:"non-iis-servers-apache-nginx-etc-on-windows-or-linux",children:[]},{value:"Clients (browsers etc)",id:"clients-browsers-etc",children:[{value:"Windows PCs",id:"windows-pcs",children:[]},{value:"macOS, iOS etc",id:"macos-ios-etc",children:[]}]},{value:"Java based systems etc",id:"java-based-systems-etc",children:[]},{value:"Azure (Application Gateway)",id:"azure-application-gateway",children:[]},{value:"Other considerations",id:"other-considerations",children:[{value:"Export Tasks",id:"export-tasks",children:[]}]},{value:"Further Troubleshooting",id:"further-troubleshooting",children:[]},{value:"Useful Information",id:"useful-information",children:[{value:"Chain Checking",id:"chain-checking",children:[]},{value:"Further Reading",id:"further-reading",children:[]}]}],h={toc:l};function p(e){var t=e.components,i=(0,n.Z)(e,["components"]);return(0,a.kt)("wrapper",(0,r.Z)({},h,i,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"summary"},"Summary"),(0,a.kt)("p",null,'Certificate trust mainly relies on the "root" issuing certificate (and intermediate certificates) being trusted by your computer. '),(0,a.kt)("p",null,'The root certificate issues an Intermediate certificate which in turn is used to issue general certificates such as the ones for your website. This is called a "Chain" of trust. Your certificate (called a Leaf or end-entity certificate) will be validated by following this chain.'),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"From Sept 30th 2021 Let's Encrypts previous root certificate "),"DST Root CA X3",(0,a.kt)("em",{parentName:"p"}," (and it's R3 intermediate) will expire. It has been replaced by their "),"ISRG Root X1",(0,a.kt)("em",{parentName:"p"}," certificate (and replacement R3 intermediate).")),(0,a.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},(0,a.kt)("strong",{parentName:"p"},"In most cases, your systems will automatically switch over to the next trusted chain they can find.")))),(0,a.kt)("h1",{id:"possible-issues"},"Possible issues"),(0,a.kt)("p",null,"In some cases, the expiry of the root (and its related expiring R3 intermediate certificate) may causes certificates to be considered untrusted or invalid. To fix this you need to make your server use (serve) the correct chain."),(0,a.kt)("p",null,"In other cases, the issue may be with the client computer."),(0,a.kt)("p",null,"The version of the ",(0,a.kt)("em",{parentName:"p"},"R3")," intermediate signing certificate which chains to ",(0,a.kt)("em",{parentName:"p"},"DST Root CA X3")," expired ",(0,a.kt)("strong",{parentName:"p"},"September 29 19:21:40 2021 GMT.")),(0,a.kt)("p",null,"The ",(0,a.kt)("em",{parentName:"p"},"DST Root CA X3")," root certificate expired ",(0,a.kt)("strong",{parentName:"p"},"September 30 14:01:15 2021 GMT"),"."),(0,a.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"CA Migration Recommended On Windows if you need to support old devices")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"In testing we have confirmed that when ",(0,a.kt)("inlineCode",{parentName:"p"},"DST Root CA X3")," expires, although Windows can initially serve the legacy chain intended for Android compatibility, it will revert to the modern chain automatically when it notices ",(0,a.kt)("inlineCode",{parentName:"p"},"DST Root CA X3")," has expired, if ",(0,a.kt)("inlineCode",{parentName:"p"},"ISRG Root X1 (self signed)")," is also present in the trust store. A ",(0,a.kt)("a",{parentName:"p",href:"#switching-to-chain-2-legacy"},"workaround is available")),(0,a.kt)("p",{parentName:"div"},"This means Windows services like IIS generally will not continue to serve content to older operating systems which don't trust ",(0,a.kt)("inlineCode",{parentName:"p"},"ISRG Root X1"),". If you require legacy support without workarounds, you should change ",(0,a.kt)("a",{parentName:"p",href:"/docs/guides/certificate-authorities"},"Certificate Authority"),"."))),(0,a.kt)("h1",{id:"solutions"},"Solutions"),(0,a.kt)("h2",{id:"servers"},"Servers"),(0,a.kt)("p",null,"The following solutions mainly apply to Windows servers running IIS or other windows based services which use the windows trust store. Unless otherwise noted they are not specific to using Certify The Web. Apache, nginx etc have their own trust mechanisms :"),(0,a.kt)("h3",{id:"servers-with-problems-after-expiry"},"Servers with problems after expiry"),(0,a.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Check Your Chain")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"1 - To diagnose a chain issue for your server, scan one of your webservers domains with a ",(0,a.kt)("a",{parentName:"p",href:"#chain-checking"},"chain checker")),(0,a.kt)("p",{parentName:"div"},"2 - If your chain contains the expired R3 after it's expiry, reboot your server to clear cached chains."),(0,a.kt)("p",{parentName:"div"},"3 - If the chain issue persists, re-request your certificate in Certify The Web to force a binding refresh or choose ",(0,a.kt)("inlineCode",{parentName:"p"},"Certificate > Advanced > Actions > Re-apply Certificate To Bindings"),"."))),(0,a.kt)("h3",{id:"server-fixes-and-how-to-switch-chain-before-or-after-expiry"},"Server fixes and how to switch chain before (or after) expiry"),(0,a.kt)("p",null,"We recommend the following steps to initially correct your servers certificate chain:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Install the latest version of ",(0,a.kt)("em",{parentName:"li"},"Certify The Web")," from ",(0,a.kt)("a",{parentName:"li",href:"https://certifytheweb.com"},"https://certifytheweb.com")," or use the in-app update process. Even if you are not using this app currently, the upgrade will automatically fix common trust store issues (and it can then be uninstalled if not being used)."),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},"Reboot your server")," (this forces windows to re-evaluate the served certificate chains). You may be able to avoid this reboot by using ",(0,a.kt)("inlineCode",{parentName:"li"},"iisreset /restart")," to just restart IIS."),(0,a.kt)("li",{parentName:"ol"},"Check your certificate chain with a ",(0,a.kt)("a",{parentName:"li",href:"#chain-checking"},"chain checker")),(0,a.kt)("li",{parentName:"ol"},"In some cases you may need to refresh your IIS bindings, the easiest method is to click 'Request Certificate' to change certificate and update bindings.")),(0,a.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Valid Chains")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"The default chain served by Windows (depending on the state of your server trust store) will be either:"),(0,a.kt)("h4",{parentName:"div",id:"chain-1-modern--your-cert--r3--isrg-root-x1"},(0,a.kt)("strong",{parentName:"h4"},"Chain 1 (modern)")," : (your cert) > R3 > ISRG Root X1"),(0,a.kt)("p",{parentName:"div"},"This chain is supported by current operating systems"),(0,a.kt)("h4",{parentName:"div",id:"chain-2-legacy--your-cert--r3--isrg-root-x1--dst-root-ca-x3"},(0,a.kt)("strong",{parentName:"h4"},"Chain 2 (legacy)")," : (your cert) > R3 > ISRG Root X1 > DST Root CA X3"),(0,a.kt)("p",{parentName:"div"},"This chain is ideal if you need broader compatibility with older operating systems, including Android 7.1 and lower. This chain is ",(0,a.kt)("a",{parentName:"p",href:"#switching-to-chain-2-legacy"},"difficult to support on Windows")),(0,a.kt)("p",{parentName:"div"},"For IIS etc, you can only serve one of these chains per Windows server (machine), not a combination per site etc. The default trust store maintenance in Certify The Web will provide the ",(0,a.kt)("em",{parentName:"p"},"modern")," chain. If you need the legacy chain you may still need import the cross signed ISRG Root X1 (see ",(0,a.kt)("em",{parentName:"p"},"Switching to Chain 2"),", below) unless it was already installed."),(0,a.kt)("p",{parentName:"div"},"Either chain is fine for most purposes (see above warning). "))),(0,a.kt)("p",null,"If you still see this old chain after the DST Root CA X3 expiry (after updating Certify The Web and after rebooting), then you need to resolve this urgently. At a minimum you must ensure ISRG Root X1 (Self signed) is installed under your machine Trusted Certification Authorities using certlm.msc and remove the R3 issued by DST Root CA X3 from Intermediate Certification Authorities. See the ",(0,a.kt)("a",{parentName:"p",href:"#further-troubleshooting"},"further troubleshooting")," section below.\n:::"),(0,a.kt)("h3",{id:"switching-to-chain-1-modern"},"Switching to Chain 1 (modern)"),(0,a.kt)("p",null,"If you are serving the ",(0,a.kt)("em",{parentName:"p"},"ISRG Root X1 > DST Root CA X3 (self signed)")," chain and want to switch to just the ",(0,a.kt)("em",{parentName:"p"},"ISRG Root X1")," chain:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"remove the cross signed version of the ISRG Root X1 (issued by DST Root CA X3) from your machine trust store. "),(0,a.kt)("li",{parentName:"ul"},"You may need to reboot to see the effect.")),(0,a.kt)("h3",{id:"switching-to-chain-2-legacy"},"Switching to Chain 2 (legacy)"),(0,a.kt)("p",null,"If you require compatibility with old versions of Android and other devices that don't know about ",(0,a.kt)("em",{parentName:"p"},"ISRG Root X1"),", you need to serve ",(0,a.kt)("strong",{parentName:"p"},"Chain 2"),". "),(0,a.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"Caution - Workaround")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"A previously proposed workaround was to move ",(0,a.kt)("inlineCode",{parentName:"p"},"ISRG Root X1 (self signed)")," to the ",(0,a.kt)("inlineCode",{parentName:"p"},"Untrusted")," store in order to serve the legacy ",(0,a.kt)("inlineCode",{parentName:"p"},"DST Root CA X3")," chain. This has unintended side effects (your server cannot validate https connections against services such as the Let's Encrypt API)."),(0,a.kt)("p",{parentName:"div"},"Servers which do not yet trust ",(0,a.kt)("inlineCode",{parentName:"p"},"ISRG Root X1 (self signed)")," will be serving the legacy chain but will automatically switch when their trust store updates."),(0,a.kt)("p",{parentName:"div"},"Instead, if you require this chain for compatibility, either use a proxy (Caddy, nginx, Apache) in front of IIS and use the proxy to terminate TLS, or migrate to a different certificate authority."))),(0,a.kt)("p",null,"If no other solution works or for any other reason you cannot update client trusts stores etc or require other broader compatibility, you may need to consider moving your certificate to a new Certificate Authority. Certify The Web supports a range of built-in ",(0,a.kt)("a",{parentName:"p",href:"/docs/guides/certificate-authorities"},"alternatives"),". You could also alternatively use a front-end proxy service such as Caddy, nginx, Apache, or a hosted DNS proxy service like Cloudflare, but these require significant changes to implement."),(0,a.kt)("h2",{id:"non-iis-servers-apache-nginx-etc-on-windows-or-linux"},"Non-IIS servers (Apache, nginx etc on Windows or Linux)"),(0,a.kt)("p",null,"Verify that your service is configured to use your certificate, with it's private key ",(0,a.kt)("em",{parentName:"p"},"and")," it's ",(0,a.kt)("strong",{parentName:"p"},"chain"),". These services will work without pointing to a chain file but in the case of the expired R3 your clients will try to resolve the R3 themselves (because you haven't given it to them) and they may then resolve it to the old (expired) one."),(0,a.kt)("h2",{id:"clients-browsers-etc"},"Clients (browsers etc)"),(0,a.kt)("p",null,"If your site is working for most devices but not for some, the problem is with their trust store (their list of trusted root certificate)."),(0,a.kt)("h3",{id:"windows-pcs"},"Windows PCs"),(0,a.kt)("p",null,"On windows PCs, simply browsing to a website using Chrome, Edge etc with updated the client trust store with the required certificates. Browsing to ",(0,a.kt)("a",{parentName:"p",href:"https://valid-isrgrootx1.letsencrypt.org/"},"https://valid-isrgrootx1.letsencrypt.org/")," will prompt Windows to include ",(0,a.kt)("em",{parentName:"p"},"ISRG Root X1")," in its trust store automatically."),(0,a.kt)("h3",{id:"macos-ios-etc"},"macOS, iOS etc"),(0,a.kt)("p",null,"Some operating systems hold onto the expired ",(0,a.kt)("inlineCode",{parentName:"p"},"R3 > DST Root CA X3")," chain even if your server is no longer using it. Try a restart of the affected client device."),(0,a.kt)("p",null,"For older macOS not updated by Apple:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Download ",(0,a.kt)("a",{parentName:"li",href:"http://x1.i.lencr.org/"},"http://x1.i.lencr.org/")),(0,a.kt)("li",{parentName:"ul"},"Open the Keychain Access app and dragging that file into the System folder of that app."),(0,a.kt)("li",{parentName:"ul"},'then find the ISRG Root X1 certificate in System and double click on it, open the Trust menu and change "Use System Defaults" to "Always Trust", then close that and enter your password to confirm the change (if prompted).')),(0,a.kt)("h2",{id:"java-based-systems-etc"},"Java based systems etc"),(0,a.kt)("p",null,"Some applications maintain their own trust store. You may need to add the newer ISRG Root X1 certificate into your systems trusts store. Any system that can't be updated needs to see the legacy chain or you need to switch CA."),(0,a.kt)("p",null,"e.g. for Java you might use: ",(0,a.kt)("inlineCode",{parentName:"p"},"keytool -import -alias isrgrootx1 -keystore $JAVA_HOME/jre/lib/security/cacerts -trustcacerts -file isrgrootx1.cer")," (",(0,a.kt)("a",{parentName:"p",href:"https://community.letsencrypt.org/t/help-thread-for-dst-root-ca-x3-expiration-september-2021/149190/258"},"credit"),")"),(0,a.kt)("h2",{id:"azure-application-gateway"},"Azure (Application Gateway)"),(0,a.kt)("p",null,"Ensure that the HTTP settings for back-end hosts are updated with the latest Trusted Root Certificate. Download ",(0,a.kt)("a",{parentName:"p",href:"https://letsencrypt.org/certs/isrgrootx1.pem"},"https://letsencrypt.org/certs/isrgrootx1.pem")," (same as .cer file) and upload via the Azure Portal or via PowerShell. See ",(0,a.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/azure/application-gateway/application-gateway-backend-health-troubleshooting"},"Application Gateway Troubleshooting")," for further details."),(0,a.kt)("h2",{id:"other-considerations"},"Other considerations"),(0,a.kt)("h3",{id:"export-tasks"},"Export Tasks"),(0,a.kt)("p",null,'If you use Certify The Web to export certificates to pem files etc (for Apache or other servers), the chain you get in the export will correspond with the chain your server is currently building. The "Preferred Issuer" setting for the certificate authority will have ',(0,a.kt)("em",{parentName:"p"},"no effect"),", because Windows is overriding the chain."),(0,a.kt)("h2",{id:"further-troubleshooting"},"Further Troubleshooting"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"A registry method to delete the old R3 is ",(0,a.kt)("a",{parentName:"li",href:"https://gist.github.com/skusiak/83db2ba2fc1804b89151db01e97bbbec"},"documented here")),(0,a.kt)("li",{parentName:"ul"},"If your expired chain keeps coming back, move (or install) the expired ",(0,a.kt)("inlineCode",{parentName:"li"},"R3 issued by DST Root CA X3")," into the Untrusted store using ",(0,a.kt)("inlineCode",{parentName:"li"},"certlm.msc")," (Manage Computer Certificates)."),(0,a.kt)("li",{parentName:"ul"},"Further information and troubleshooting steps are here: ",(0,a.kt)("a",{parentName:"li",href:"https://community.certifytheweb.com/t/upcoming-expiry-of-dst-root-ca-x3-and-r3-intermediate-for-lets-encrypt/1480"},"https://community.certifytheweb.com/t/upcoming-expiry-of-dst-root-ca-x3-and-r3-intermediate-for-lets-encrypt/1480"))),(0,a.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Licensed Users can contact Certify The Web support")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"While the problem itself relates to and is controlled by Windows and Let's Encrypt, licensed users can contact Certify The Web support via ",(0,a.kt)("inlineCode",{parentName:"p"},"support at certifytheweb.com")," if they have further related questions and issues they need advice with. We are in the AEST (Australia) Time Zone. A higher than normal volume of support tickets are expected immediately up to, during and after the root expiry so please expect delays and perform as much of your own troubleshooting and research as you can."))),(0,a.kt)("h2",{id:"useful-information"},"Useful Information"),(0,a.kt)("p",null,"Visit the Let's Encrypt support community for more information about the root expiry and chain changes: ",(0,a.kt)("a",{parentName:"p",href:"https://community.letsencrypt.org/t/production-chain-changes/150739/4"},"https://community.letsencrypt.org/t/production-chain-changes/150739/4")),(0,a.kt)("h3",{id:"chain-checking"},"Chain Checking"),(0,a.kt)("p",null,"Other ways to check and diagnose chain issues:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Qualsys SSL Server Test: ",(0,a.kt)("a",{parentName:"li",href:"https://www.ssllabs.com/ssltest/"},"https://www.ssllabs.com/ssltest/")," is useful for full diagnostics of your certificate chain."),(0,a.kt)("li",{parentName:"ul"},"Namecheap SSL Checker: ",(0,a.kt)("a",{parentName:"li",href:"https://decoder.link/sslchecker/"},"https://decoder.link/sslchecker/")),(0,a.kt)("li",{parentName:"ul"},"OpenSSL: ",(0,a.kt)("inlineCode",{parentName:"li"},"openssl s_client -connect your.domain.com:443 -servername  your.domain.com"))),(0,a.kt)("h3",{id:"further-reading"},"Further Reading"),(0,a.kt)("p",null,"The Windows certificate chaining engine: ",(0,a.kt)("a",{parentName:"p",href:"https://social.technet.microsoft.com/wiki/contents/articles/3147.pki-certificate-chaining-engine-cce.aspx"},"https://social.technet.microsoft.com/wiki/contents/articles/3147.pki-certificate-chaining-engine-cce.aspx")))}p.isMDXComponent=!0}}]);